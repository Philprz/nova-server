# -------------------------------
# start_server.ps1 - Version corrigee
# -------------------------------
Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass

# (1) Aller dans le dossier projet
Write-Host "Changement de repertoire vers C:\Users\PPZ\NOVA"
Set-Location "C:\Users\PPZ\NOVA"

# (2) Activer l'environnement virtuel (.venv attendu dans ./venv)
if (Test-Path ".\venv\Scripts\Activate.ps1") {
    Write-Host "Activation de l'environnement virtuel..."
    .\venv\Scripts\Activate.ps1
} else {
    Write-Host "Aucun environnement virtuel trouve (./venv)."
    Write-Host "MCP sera lance avec l'environnement Python global."
}

# (3) Verification presence de MCP SDK
try {
    pip show mcp | Out-Null
    Write-Host "MCP SDK detecte."
} catch {
    Write-Host "MCP CLI ou SDK non installe. Execute : pip install 'mcp[cli]'"
    Pause
    exit
}

# (4) Lancer le serveur MCP Python
Write-Host "Lancement du serveur MCP (server_mcp.py)..."
python server_mcp.py

# (5) Fin du script
Write-Host "Serveur MCP arrete. Appuyez sur une touche pour fermer."
Pause
